<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Jogo do Snake</title>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const canvas = document.querySelector("canvas");
            const canvasCtx = canvas.getContext("2d");

            const box = 32;

            const randomXY = () => {
                return {
                    x: Math.floor(Math.random() * 17 + 1) * box,
                    y: Math.floor(Math.random() * 15 + 3) * box
                }
            }

            const snake = [];
            snake[0] = randomXY();

            const groundImg = new Image ();
            groundImg.src = "images/ground.png"

            const foodImg = new Image ();
            foodImg.src = "images/food.png"

            let food = randomXY();

            const gameDrawing = setInterval(function() {
                canvasCtx.drawImage(groundImg, 0, 0);

                canvasCtx.drawImage(foodImg, food.x, food.y);

                for(let i = 0; i < snake.length; i++) {

                    /*if (i === 0) {
                        canvasCtx.fillStyle = "#FFF";
                    } else {
                        canvasCtx.fillStyle = "#060";
                    }*/

                    canvasCtx.fillStyle = i === 0 ? "#FFF" : "#060";

                    canvasCtx.fillRect(snake[i].x, snake[i].y, box, box);

                    canvasCtx.strokeStyle = "#F00";
                    canvasCtx.strokeRect(snake[i].x, snake[i].y, box, box);
                }
        
            }, 100);

            const collisionChecker = (snake) => {
                for(let i = 1; i < snake.length ; i++) {
                    if(snake[0].x === snake[i].x && snake[0].y === snake[i].y){
                        return true;
                    }
                }
            }

            document.addEventListener("keydown", (e) => {
                let snakeX = snake[0].x;
                let snakeY = snake[0].y;

                if ( e.keyCode === 37) {
                    snakeX -= box;
                } 
                if (e.keyCode === 38 ) {
                    snakeY -= box;
                }
                if (e.keyCode === 39 ) {
                    snakeX += box;
                }
                if (e.keyCode === 40 ) {
                    snakeY += box;
                }

                /*Verificação de game over*/

                if(snakeX < box || snakeY < box*3 || snakeX > box*17 || snakeY > box*17 || collisionChecker(snake) ) {
                    alert("GAME OVER");
                    clearInterval(gameDrawing);

                }

                snake.unshift({x: snakeX, y: snakeY});

                if (snakeX === food.x && snakeY === food.y) {
                    /*comeu*/
                    food = randomXY();
                }
                else{
                    snake.pop();
                }
            });


        })
    </script>
</head>
<body>
    <main>
        <canvas width="608" height="608"></canvas>
    </main>
</body>
</html>